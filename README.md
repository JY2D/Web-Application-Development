# Citizen Science Web Application
You can run the Python server with the command:
```
python main.py
``` 

The server will listen for requests on 
[http://localhost:8010](http://localhost:8010/).

# Tests
The `cypress` directory contains tests to be run with the [Cypress](https://cypress.io) testing tool.
This runs the tests to see if you are functional and display different data

## The API Server

The Python API server provides the following URLs serving JSON data:

* `/api/users` - GET returns a JSON array of user details
* `/api/users/<id>` - GET returns details of an individual user
* `/api/observations` - GET returns a JSON array of observation records
* `/api/observations` - POST adds a new observation record (required fields below)
* `/api/observations/<id>` - GET returns details of an individual observation
* `/api/reset` - GET request resets the database (for testing purposes)

An example of what a json observation object looks like is:
        {
            "id": 0,
            "participant": 78,
            "timestamp": "2020-04-27T15:09:58.250335",
            "temperature": 21,
            "weather": "sunny",
            "wind": "none",
            "location": "Eastwood",
            "height": 12,
            "girth": 3.01,
            "leaf_size": "small",
            "leaf_shape": "pointy",
            "bark_colour": "silver",
            "bark_texture": "spotty"
        }
The above fields are found on the submission form in `/js/form.js`
**participant** - participant id, has a hidden field because Bob is logged in
**temperature** - has a numerical field
**weather** - has a select field with the following options for "fine", "raining", "sunny", "stormy"
**wind** - has a select field with the following options for "none", "light", "medium", "strong"
**location** - has a text input
**height** - has a float numerical field with min of 0
**girth** - has a float numerical field with min of 0
**leaf_size** - has a select field with the following options for "small", "medium", "large"
**leaf_shape** - has a select field with the following options for "rounded", "pointy", "divided"
**bark_colour** - has a select field with the following options for "grey", "red", "silver", "brown"
**bark_texture** - has a select field with the following options for "smooth", "peeling", "crinkles", "furry", "spotty"

## WebPage

The main page of the application is generated by the Python code from the file `index.html` in the `views` folder. Static files are served from the `static` folder. You will see sub-folders for CSS, Javascript and images.  

## The API Server

The Python API server provides the following URLs serving JSON data:

* `/api/users` - GET returns a JSON array of user details
* `/api/users/<id>` - GET returns details of an individual user
* `/api/observations` - GET returns a JSON array of observation records
* `/api/observations` - POST adds a new observation record (required fields below)
* `/api/observations/<id>` - GET returns details of an individual observation
* `/api/reset` - GET request resets the database (for testing purposes)

## Templates

**show-observation-template**: View to display obervations belonging to a user
**show-list-of-observations-template**: View to display all observations
**show-person-template**: View to display a user
**show-list-of-people-template**: View to display all users
**show-list-of-top-template**: View to display top ten users


## Javascript 
* `form.js` is where all functions used by the form to submit an observation is found
* `main.js` contains the main function to redraw    
* `model.js` contains all functions that are required to interact with APIs
* `util.js` includes split_hash utility function
* `views.js` contains the different views used in the html templates to display

## Pages
There are four different view pages in this WebPage.

**Home Page** (/#): This page contains a list of recent observations, current top 10 leaderboard of users. Each user or observation will link to their own individual pages showing more details of the user or observation.
**Users Page** (/#!/users): This users page shows a list of all the users. When clicked upon it will lead to a personal view of their avatar and details, with a short list of observations made by them.
**Observations Page** (/#!/observations): This observation page shows the complete list of observations. When clicked upon it will lead you to the obersvation in more detail. Each of the observations includes the time, location and weather.
**Submit a Form** (/#!/submit): This page contains the form to submit a new observation. The user will fill out the form and submit it but if the form is incomplete, and one of the options are left blank, a list of errors will be shown and the user will have to resubmit the form. Otherwise, if the submission of the form is successful, it will lead to the user's profile where other observations can be seen as well as the new observation.


